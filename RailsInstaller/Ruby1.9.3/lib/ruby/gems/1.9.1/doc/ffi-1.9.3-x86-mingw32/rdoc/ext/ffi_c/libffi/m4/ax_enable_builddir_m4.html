<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>ax_enable_builddir.m4 - ffi-1.9.3-x86-mingw32 Documentation</title>

<link href="../../../../fonts.css" rel="stylesheet">
<link href="../../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../";
</script>

<script src="../../../../js/jquery.js"></script>
<script src="../../../../js/navigation.js"></script>
<script src="../../../../js/search_index.js"></script>
<script src="../../../../js/search.js"></script>
<script src="../../../../js/searcher.js"></script>
<script src="../../../../js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../../../ext/ffi_c/libffi/ChangeLog.html">ChangeLog</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/ChangeLog_libffi.html">ChangeLog.libffi</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/ChangeLog_libgcj.html">ChangeLog.libgcj</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/ChangeLog_v1.html">ChangeLog.v1</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/LICENSE.html">LICENSE</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/Makefile_am.html">Makefile.am</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/Makefile_in.html">Makefile.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/Makefile_vc.html">Makefile.vc</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/Makefile_vc64.html">Makefile.vc64</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/README.html">README</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/acinclude_m4.html">acinclude.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/build-ios_sh.html">build-ios.sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/compile.html">compile</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/config_guess.html">config.guess</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/config_sub.html">config.sub</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/configure.html">configure</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/configure_ac.html">configure.ac</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/configure_host.html">configure.host</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/depcomp.html">depcomp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/doc/libffi_info.html">libffi.info</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/doc/stamp-vti.html">stamp-vti</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/doc/version_texi.html">version.texi</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/fficonfig_h_in.html">fficonfig.h.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/include/Makefile_am.html">Makefile.am</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/include/Makefile_in.html">Makefile.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/install-sh.html">install-sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/libffi_pc_in.html">libffi.pc.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/libtool-version.html">libtool-version</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/ltmain_sh.html">ltmain.sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_cc_maxopt_m4.html">ax_cc_maxopt.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_cflags_warn_all_m4.html">ax_cflags_warn_all.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_check_compiler_flags_m4.html">ax_check_compiler_flags.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_compiler_vendor_m4.html">ax_compiler_vendor.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_configure_args_m4.html">ax_configure_args.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_enable_builddir_m4.html">ax_enable_builddir.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_gcc_archflag_m4.html">ax_gcc_archflag.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/m4/ax_gcc_x86_cpuid_m4.html">ax_gcc_x86_cpuid.m4</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/man/Makefile_am.html">Makefile.am</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/man/Makefile_in.html">Makefile.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/man/ffi_3.html">ffi.3</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/man/ffi_call_3.html">ffi_call.3</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/man/ffi_prep_cif_3.html">ffi_prep_cif.3</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/mdate-sh.html">mdate-sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/missing.html">missing</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/msvcc_sh.html">msvcc.sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/alpha/osf_S.html">osf.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/arm/gentramp_sh.html">gentramp.sh</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/arm/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/arm/trampoline_S.html">trampoline.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/avr32/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/cris/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/frv/eabi_S.html">eabi.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/ia64/unix_S.html">unix.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/m32r/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/m68k/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/mips/n32_S.html">n32.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/mips/o32_S.html">o32.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/moxie/eabi_S.html">eabi.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/pa/hpux32_S.html">hpux32.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/pa/linux_S.html">linux.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/aix_S.html">aix.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/aix_closure_S.html">aix_closure.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/darwin_S.html">darwin.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/darwin_closure_S.html">darwin_closure.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/linux64_S.html">linux64.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/linux64_closure_S.html">linux64_closure.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/ppc_closure_S.html">ppc_closure.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/powerpc/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/s390/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/sh/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/sh64/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/sparc/v8_S.html">v8.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/sparc/v9_S.html">v9.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/darwin_S.html">darwin.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/darwin64_S.html">darwin64.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/freebsd_S.html">freebsd.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/sysv_S.html">sysv.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/unix64_S.html">unix64.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/win32_S.html">win32.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/src/x86/win64_S.html">win64.S</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/Makefile_am.html">Makefile.am</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/Makefile_in.html">Makefile.in</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/config/default_exp.html">default.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/lib/libffi-dg_exp.html">libffi-dg.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/lib/libffi_exp.html">libffi.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/lib/target-libpath_exp.html">target-libpath.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/lib/wrapper_exp.html">wrapper.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/libffi_call/call_exp.html">call.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/testsuite/libffi_special/special_exp.html">special.exp</a>
  
    <li><a href="../../../../ext/ffi_c/libffi/texinfo_tex.html">texinfo.tex</a>
  
    <li><a href="../../../../lib/ffi/platform/arm-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-cygwin/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-darwin/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-freebsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-gnu/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-netbsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-openbsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-solaris/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/i386-windows/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/ia64-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/mips-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/mipsel-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/powerpc-aix/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/powerpc-darwin/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/powerpc-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/s390-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/s390x-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/sparc-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/sparc-solaris/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/sparcv9-solaris/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-cygwin/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-darwin/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-freebsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-linux/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-netbsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-openbsd/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-solaris/types_conf.html">types.conf</a>
  
    <li><a href="../../../../lib/ffi/platform/x86_64-windows/types_conf.html">types.conf</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page ext/ffi_c/libffi/m4/ax_enable_builddir.m4">

<p>#
===========================================================================
#    <a
href="http://www.gnu.org/software/autoconf-archive/ax_enable_builddir.html">www.gnu.org/software/autoconf-archive/ax_enable_builddir.html</a>
#
===========================================================================
# # SYNOPSIS # #   AX_ENABLE_BUILDDIR [(dirstring-or-command [,Makefile.mk
[,-all]])] # # DESCRIPTION # #   If the current configure was run within
the srcdir then we move all #   configure-files into a subdir and let the
configure steps continue #   there. We provide an option –disable-builddir
to suppress the move into #   a separate builddir. # #   Defaults: # #    
$1 = $host (overridden with $HOST) #     $2 = Makefile.mk #     $3 = -all #
#   This macro must be called before AM_INIT_AUTOMAKE. It creates a default
#   toplevel srcdir Makefile from the information found in the created #  
toplevel builddir Makefile. It just copies the variables and #  
rule-targets, each extended with a default rule-execution that recurses #  
into the build directory of the current “HOST”. You can override the #  
auto-dection through `config.guess` and build-time of course, as in # #    
make HOST=i386-mingw-cross # #   which can of course set at configure time
as well using # #     configure –host=i386-mingw-cross # #   After the
default has been created, additional rules can be appended #   that will
not just recurse into the subdirectories and only ever exist #   in the
srcdir toplevel makefile - these parts are read from the $2 = #  
Makefile.mk file # #   The automatic rules are usually scanning the
toplevel Makefile for lines #   like ‘#### $host |$builddir’ to recognize
the place where to recurse #   into. Usually, the last one is the only one
used. However, almost all #   targets have an additional “*-all” rule which
makes the script to #   recurse into <em>all</em> variants of the current
HOST (!!) setting. The “-all” #   suffix can be overriden for the macro as
well. # #   a special rule is only given for things like “dist” that will
copy the #   tarball from the builddir to the sourcedir (or $(PUB)) for
reason of #   convenience. # # <a href="../LICENSE.html">LICENSE</a> # #  
Copyright © 2009 Guido U. Draheim &lt;guidod@gmx.de&gt; #   Copyright ©
2009 Alan Jenkins &lt;alan-jenkins@tuffmail.co.uk&gt; # #   This program is
free software; you can redistribute it and/or modify it #   under the terms
of the GNU General Public License as published by the #   Free Software
Foundation; either version 3 of the License, or (at your #   option) any
later version. # #   This program is distributed in the hope that it will
be useful, but #   WITHOUT ANY WARRANTY; without even the implied warranty
of #   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
General #   Public License for more details. # #   You should have received
a copy of the GNU General Public License along #   with this program. If
not, see &lt;<a
href="http://www.gnu.org/licenses">www.gnu.org/licenses</a>/&gt;. # #   As
a special exception, the respective Autoconf Macro’s copyright owner #  
gives unlimited permission to copy, distribute and modify the configure #  
scripts that are the output of Autoconf when processing the Macro. You #  
need not follow the terms of the GNU General Public License when using #  
or distributing such scripts, even though portions of the text of the #  
Macro appear in them. The GNU General Public License (GPL) does govern #  
all other use of the material that constitutes the Autoconf Macro. # #  
This special exception to the GPL applies to versions of the Autoconf #  
Macro released by the Autoconf Archive. When you make and distribute a #  
modified version of the Autoconf Macro, you may extend this special #  
exception to the GPL to apply to your modified version as well.</p>

<p>serial 22</p>

<p><a href="AX_ENABLE_BUILDDIR">AC_DEFUN(</a>,[ <a
href="AC_CANONICAL_HOST">AC_REQUIRE(</a>)[]dnl <a
href="AX_CONFIGURE_ARGS">AC_REQUIRE(</a>)[]dnl <a
href="AM_AUX_DIR_EXPAND">AC_REQUIRE(</a>)[]dnl <a
href="$0">AC_BEFORE(</a>,[AM_INIT_AUTOMAKE])dnl <a
href="SUB">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir])dnl <a
href="AUX">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir_auxdir])dnl <a
href="SED">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir_sed])dnl SUB="." <a
href="builddir">AC_ARG_ENABLE(</a>, AS_HELP_STRING(</p>

<pre>[--disable-builddir],[disable automatic build in subdir of sources])
,[SUB=&quot;$enableval&quot;], [SUB=&quot;auto&quot;])</pre>

<p>if test “.$ac_srcdir_defaulted” != “.no” ; then if test “.$srcdir” = “..” ;
then</p>

<pre>if test -f config.status ; then
  AC_MSG_NOTICE(toplevel srcdir already configured... skipping subdir build)
else
  test &quot;.$SUB&quot; = &quot;.&quot;  &amp;&amp; SUB=&quot;.&quot;
  test &quot;.$SUB&quot; = &quot;.no&quot;  &amp;&amp; SUB=&quot;.&quot;
  test &quot;.$TARGET&quot; = &quot;.&quot; &amp;&amp; TARGET=&quot;$target&quot;
  test &quot;.$SUB&quot; = &quot;.auto&quot; &amp;&amp; SUB=&quot;m4_ifval([$1], [$1],[$TARGET])&quot;
  if test &quot;.$SUB&quot; != &quot;..&quot; ; then    # we know where to go and
    AS_MKDIR_P([$SUB])
    echo __.$SUB.__ &gt; $SUB/conftest.tmp
    cd $SUB
    if grep __.$SUB.__ conftest.tmp &gt;/dev/null 2&gt;/dev/null ; then
      rm conftest.tmp
      AC_MSG_RESULT([continue configure in default builddir &quot;./$SUB&quot;])
    else
      AC_MSG_ERROR([could not change to default builddir &quot;./$SUB&quot;])
    fi
    srcdir=`echo &quot;$SUB&quot; |
            sed -e 's,^\./,,;s,[[^/]]$,&amp;/,;s,[[^/]]*/,../,g;s,[[/]]$,,;'`
    # going to restart from subdirectory location
    test -f $srcdir/config.log   &amp;&amp; mv $srcdir/config.log   .
    test -f $srcdir/confdefs.h   &amp;&amp; mv $srcdir/confdefs.h   .
    test -f $srcdir/conftest.log &amp;&amp; mv $srcdir/conftest.log .
    test -f $srcdir/$cache_file  &amp;&amp; mv $srcdir/$cache_file  .
    AC_MSG_RESULT(....exec $SHELL $srcdir/[$]0 &quot;--srcdir=$srcdir&quot; &quot;--enable-builddir=$SUB&quot; ${1+&quot;[$]@&quot;})
    case &quot;[$]0&quot; in # restart
     [/\\]*) eval $SHELL &quot;'[$]0'&quot; &quot;'--srcdir=$srcdir'&quot; &quot;'--enable-builddir=$SUB'&quot; $ac_configure_args ;;
     *) eval $SHELL &quot;'$srcdir/[$]0'&quot; &quot;'--srcdir=$srcdir'&quot; &quot;'--enable-builddir=$SUB'&quot; $ac_configure_args ;;
    esac ; exit $?
  fi
fi</pre>

<p>fi fi test “.$SUB” = “.auto” &amp;&amp; SUB=“.” dnl ac_path_prog uses “set
dummy” to override $@ which would defeat the “exec” AC_PATH_PROG(SED,gsed
sed, sed) AUX=“$am_aux_dir” <a href="SED">AS_VAR_POPDEF(</a>)dnl <a
href="AUX">AS_VAR_POPDEF(</a>)dnl <a href="SUB">AS_VAR_POPDEF(</a>)dnl <a
href="buildir">AC_CONFIG_COMMANDS(</a>,[dnl .….….….. config.status .….….…..
<a href="SUB">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir])dnl <a
href="TOP">AS_VAR_PUSHDEF(</a>,[top_srcdir])dnl <a
href="SRC">AS_VAR_PUSHDEF(</a>,[ac_top_srcdir])dnl <a
href="AUX">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir_auxdir])dnl <a
href="SED">AS_VAR_PUSHDEF(</a>,[ax_enable_builddir_sed])dnl <a
href="END">pushdef(</a>,[Makefile.mk])dnl <a href="_ALL">pushdef(</a>,[<a
href="$3">ifelse(</a>,,[-<a href="$3">all],</a>)])dnl</p>

<pre>SRC=&quot;$ax_enable_builddir_srcdir&quot;
if test &quot;.$SUB&quot; = &quot;..&quot; ; then
  if test -f &quot;$TOP/Makefile&quot; ; then
    AC_MSG_NOTICE([skipping TOP/Makefile - left untouched])
  else
    AC_MSG_NOTICE([skipping TOP/Makefile - not created])
  fi
else
  if test -f &quot;$SRC/Makefile&quot; ; then
    a=`grep &quot;^VERSION &quot; &quot;$SRC/Makefile&quot;` ; b=`grep &quot;^VERSION &quot; Makefile`
    test &quot;$a&quot; != &quot;$b&quot; &amp;&amp; rm &quot;$SRC/Makefile&quot;
  fi
  if test -f &quot;$SRC/Makefile&quot; ; then
      echo &quot;$SRC/Makefile : $SRC/Makefile.in&quot; &gt; $tmp/conftemp.mk
      echo &quot;  []@ echo 'REMOVED,,,' &gt;\$[]@&quot; &gt;&gt; $tmp/conftemp.mk
    eval &quot;${MAKE-make} -f $tmp/conftemp.mk 2&gt;/dev/null &gt;/dev/null&quot;
    if grep '^REMOVED,,,' &quot;$SRC/Makefile&quot; &gt;/dev/null
    then rm $SRC/Makefile ; fi
    cp $tmp/conftemp.mk $SRC/makefiles.mk~      ## DEBUGGING
  fi
  if test ! -f &quot;$SRC/Makefile&quot; ; then
    AC_MSG_NOTICE([create TOP/Makefile guessed from local Makefile])
    x='`' ; cat &gt;$tmp/conftemp.sed &lt;&lt;_EOF</pre>

<p>/^$/n x /^$/bS x /\\$/{H;d;} {H;s/.*//;x;} bM :S x /\\$/{h;d;}
{h;s/.*//;x;} :M s/\(\n\)     /\1 /g /^      /d /^[[     ]]*[[\#]]/d
/^VPATH *=/d s/^srcdir *=.*/srcdir = ./ s/^top_srcdir *=.*/top_srcdir = ./
/[[:=]]/!d /^\./d dnl Now handle rules (i.e. lines containing “:” but not “
= ”). / = /b / .= /b /:/!b s/:.*/:/ s/ /  /g s/ \([[<a
href="a-z-">a-z]][</a>]*[[a-zA-Z0-9]]\)\([[ :]]\)/ \1 \1[]_ALL\2/g <a
href="a-z">s/^\([</a>][[<a href="a-zA-Z0-9">a-z-]]*[</a>]\)\([[ :]]\)/\1
\1[]_ALL\2/ s/  / /g /^all all[]_ALL[[ :]]/i\ all-configured : all[]_ALL
dnl dist-all exists… and would make for dist-all-all s/
[[a-zA-Z0-9-]]*[]_ALL [[<a href="">a-zA-Z0-9-]]*[]_ALL</a>_ALL//g
/[]_ALL[]_ALL/d a\</p>

<pre>@ HOST=&quot;\$(HOST)\&quot; \\\\\\
; test &quot;.\$\$HOST&quot; = &quot;.&quot; &amp;&amp; HOST=$x sh $AUX/config.guess $x \\\\\\
; BUILD=$x grep &quot;^#### \$\$HOST &quot; Makefile | sed -e 's/.*|//' $x \\\\\\
; use=$x basename &quot;\$\@&quot; _ALL $x; n=$x echo \$\$BUILD | wc -w $x \\\\\\
; echo &quot;MAKE \$\$HOST : \$\$n * \$\@&quot;; if test &quot;\$\$n&quot; = &quot;0&quot; ; then : \\\\\\
; BUILD=$x grep &quot;^####.*|&quot; Makefile |tail -1| sed -e 's/.*|//' $x ; fi \\\\\\
; test &quot;.\$\$BUILD&quot; = &quot;.&quot; &amp;&amp; BUILD=&quot;.&quot; \\\\\\
; test &quot;\$\$use&quot; = &quot;\$\@&quot; &amp;&amp; BUILD=$x echo &quot;\$\$BUILD&quot; | tail -1 $x \\\\\\
; for i in \$\$BUILD ; do test &quot;.\$\$i&quot; = &quot;.&quot; &amp;&amp; continue \\\\\\
; (cd &quot;\$\$i&quot; &amp;&amp; test ! -f configure &amp;&amp; \$(MAKE) \$\$use) || exit; done</pre>

<p>dnl special rule add-on: “dist” copies the tarball to $(PUB). (source tree)
/dist[]_ALL *:/a\</p>

<pre>@ HOST=&quot;\$(HOST)\&quot; \\\\\\
; test &quot;.\$\$HOST&quot; = &quot;.&quot; &amp;&amp; HOST=$x sh $AUX/config.guess $x \\\\\\
; BUILD=$x grep &quot;^#### \$\$HOST &quot; Makefile | sed -e 's/.*|//' $x \\\\\\
; found=$x echo \$\$BUILD | wc -w $x \\\\\\
; echo &quot;MAKE \$\$HOST : \$\$found \$(PACKAGE)-\$(VERSION).tar.*&quot; \\\\\\
; if test &quot;\$\$found&quot; = &quot;0&quot; ; then : \\\\\\
; BUILD=$x grep &quot;^#### .*|&quot; Makefile |tail -1| sed -e 's/.*|//' $x \\\\\\
; fi ; for i in \$\$BUILD ; do test &quot;.\$\$i&quot; = &quot;.&quot; &amp;&amp; continue \\\\\\
; for f in \$\$i/\$(PACKAGE)-\$(VERSION).tar.* \\\\\\
; do test -f &quot;\$\$f&quot; &amp;&amp; mv &quot;\$\$f&quot; \$(PUB). ; done ; break ; done</pre>

<p>dnl special rule add-on: “dist-foo” copies all the archives to $(PUB).
(source tree) /<a href="a-zA-Z0-9">dist-[</a>]*[]_ALL *:/a\</p>

<pre>@ HOST=&quot;\$(HOST)\&quot; \\\\\\
; test &quot;.\$\$HOST&quot; = &quot;.&quot; &amp;&amp; HOST=$x sh ./config.guess $x \\\\\\
; BUILD=$x grep &quot;^#### \$\$HOST &quot; Makefile | sed -e 's/.*|//' $x \\\\\\
; found=$x echo \$\$BUILD | wc -w $x \\\\\\
; echo &quot;MAKE \$\$HOST : \$\$found \$(PACKAGE)-\$(VERSION).*&quot; \\\\\\
; if test &quot;\$\$found&quot; = &quot;0&quot; ; then : \\\\\\
; BUILD=$x grep &quot;^#### .*|&quot; Makefile |tail -1| sed -e 's/.*|//' $x \\\\\\
; fi ; for i in \$\$BUILD ; do test &quot;.\$\$i&quot; = &quot;.&quot; &amp;&amp; continue \\\\\\
; for f in \$\$i/\$(PACKAGE)-\$(VERSION).* \\\\\\
; do test -f &quot;\$\$f&quot; &amp;&amp; mv &quot;\$\$f&quot; \$(PUB). ; done ; break ; done</pre>

<p>dnl special rule add-on: “distclean” removes all local builddirs completely
/distclean[]_ALL *:/a\</p>

<pre>@ HOST=&quot;\$(HOST)\&quot; \\\\\\
; test &quot;.\$\$HOST&quot; = &quot;.&quot; &amp;&amp; HOST=$x sh $AUX/config.guess $x \\\\\\
; BUILD=$x grep &quot;^#### .*|&quot; Makefile | sed -e 's/.*|//' $x \\\\\\
; use=$x basename &quot;\$\@&quot; _ALL $x; n=$x echo \$\$BUILD | wc -w $x \\\\\\
; echo &quot;MAKE \$\$HOST : \$\$n * \$\@ (all local builds)&quot; \\\\\\
; test &quot;.\$\$BUILD&quot; = &quot;.&quot; &amp;&amp; BUILD=&quot;.&quot; \\\\\\
; for i in \$\$BUILD ; do test &quot;.\$\$i&quot; = &quot;.&quot; &amp;&amp; continue \\\\\\
; echo &quot;# rm -r \$\$i&quot;; done ; echo &quot;# (sleep 3)&quot; ; sleep 3 \\\\\\
; for i in \$\$BUILD ; do test &quot;.\$\$i&quot; = &quot;.&quot; &amp;&amp; continue \\\\\\
; echo &quot;\$\$i&quot; | grep &quot;^/&quot; &gt; /dev/null &amp;&amp; continue \\\\\\
; echo &quot;\$\$i&quot; | grep &quot;^../&quot; &gt; /dev/null &amp;&amp; continue \\\\\\
; echo &quot;rm -r \$\$i&quot;; (rm -r &quot;\$\$i&quot;) ; done ; rm Makefile</pre>

<p>_EOF</p>

<pre>    cp &quot;$tmp/conftemp.sed&quot; &quot;$SRC/makefile.sed~&quot;            ## DEBUGGING
    $SED -f $tmp/conftemp.sed Makefile &gt;$SRC/Makefile
    if test -f &quot;$SRC/m4_ifval([$2],[$2],[END])&quot; ; then
      AC_MSG_NOTICE([extend TOP/Makefile with TOP/m4_ifval([$2],[$2],[END])])
      cat $SRC/END &gt;&gt;$SRC/Makefile
    fi ; xxxx=&quot;####&quot;
    echo &quot;$xxxx CONFIGURATIONS FOR TOPLEVEL MAKEFILE: &quot; &gt;&gt;$SRC/Makefile
    # sanity check
    if grep '^; echo &quot;MAKE ' $SRC/Makefile &gt;/dev/null ; then
      AC_MSG_NOTICE([buggy sed found - it deletes tab in &quot;a&quot; text parts])
      $SED -e '/^@ HOST=/s/^/ /' -e '/^; /s/^/        /' $SRC/Makefile \
        &gt;$SRC/Makefile~
      (test -s $SRC/Makefile~ &amp;&amp; mv $SRC/Makefile~ $SRC/Makefile) 2&gt;/dev/null
    fi
  else
    xxxx=&quot;\\#\\#\\#\\#&quot;
    # echo &quot;/^$xxxx *$ax_enable_builddir_host /d&quot; &gt;$tmp/conftemp.sed
    echo &quot;s!^$xxxx [[^|]]* | *$SUB *\$!$xxxx ...... $SUB!&quot; &gt;$tmp/conftemp.sed
    $SED -f &quot;$tmp/conftemp.sed&quot; &quot;$SRC/Makefile&quot; &gt;$tmp/mkfile.tmp
      cp &quot;$tmp/conftemp.sed&quot; &quot;$SRC/makefiles.sed~&quot;         ## DEBUGGING
      cp &quot;$tmp/mkfile.tmp&quot;   &quot;$SRC/makefiles.out~&quot;         ## DEBUGGING
    if cmp -s &quot;$SRC/Makefile&quot; &quot;$tmp/mkfile.tmp&quot; 2&gt;/dev/null ; then
      AC_MSG_NOTICE([keeping TOP/Makefile from earlier configure])
      rm &quot;$tmp/mkfile.tmp&quot;
    else
      AC_MSG_NOTICE([reusing TOP/Makefile from earlier configure])
      mv &quot;$tmp/mkfile.tmp&quot; &quot;$SRC/Makefile&quot;
    fi
  fi
  AC_MSG_NOTICE([build in $SUB (HOST=$ax_enable_builddir_host)])
  xxxx=&quot;####&quot;
  echo &quot;$xxxx&quot; &quot;$ax_enable_builddir_host&quot; &quot;|$SUB&quot; &gt;&gt;$SRC/Makefile
fi</pre>

<p><a href="END">popdef(</a>)dnl <a href="SED">AS_VAR_POPDEF(</a>)dnl <a
href="AUX">AS_VAR_POPDEF(</a>)dnl <a href="SRC">AS_VAR_POPDEF(</a>)dnl <a
href="TOP">AS_VAR_POPDEF(</a>)dnl <a href="SUB">AS_VAR_POPDEF(</a>)dnl
],[dnl ax_enable_builddir_srcdir="$srcdir"                    # $srcdir
ax_enable_builddir_host="$HOST"                        # $HOST / $host
ax_enable_builddir_version="$VERSION"                  # $VERSION
ax_enable_builddir_package="$PACKAGE"                  # $PACKAGE
ax_enable_builddir_auxdir="$ax_enable_builddir_auxdir" # $AUX
ax_enable_builddir_sed="$ax_enable_builddir_sed"       # $SED
ax_enable_builddir="$ax_enable_builddir"               # $SUB ])dnl ])</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

